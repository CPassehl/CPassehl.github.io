<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>grab that video</title>
    <!-- <script src="/Library/WebServer/Documents/p5.dom.js" type="text/javascript"></script>

    <script src="/Library/WebServer/Documents/p5.js" type="text/javascript"></script>

    <script src="/Library/WebServer/Documents/p5.min.js" type="text/javascript"></script>

    <script src="/Library/WebServer/Documents/p5.sound.js" type="text/javascript"></script> -->

    

<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/addons/p5.dom.js" integrity="sha256-XJv4F6vIKIxDBK9yFUP0+7QP6z7AHjwNvmAS/ZsNogM=" crossorigin="anonymous"></script>
  
  <script src="libraries/p5.serialport.js" type="text/javascript"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/p5.js" integrity="sha256-hTadFyx999S2PaNVgI6MyGaojC6fzBZb2D5GibT/Fno=" crossorigin="anonymous"></script>

    <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/addons/p5.dom.js"></script>  

    <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/addons/p5.sound.js"></script> 

</head>
<body>

<!-- <script>
    var vid1;
    var capture;

function setup() {
  createCanvas(800, 600);
  // specify multiple formats for different browsers
  capture = createCapture(VIDEO);
  //createVideo(['assets/fingers.mov','assets/fingers.webm']);
  capture.size(700, 500);
  //vid1.loop();
  //vid1.hide();
  noStroke();
  fill(0);

  //capture.hide();
}

// function setup() {
//   createCanvas(480, 120);
//   var constraints = {
//     video: {
//       mandatory: {
//         minWidth: 1280,
//         minHeight: 720
//       },
//       optional: [
//         { maxFrameRate: 10 }
//       ]
//     },
//     audio: true
//   };
//   createCapture(constraints, function(stream) {
//     console.log(stream);
//   });
// }

function draw() {
  background(255);
  image(capture, 0, 0, 700, 500);
  filter('INVERT');
  // vid1.loadPixels();
  // var stepSize = round(constrain(mouseX / 8, 6, 32));
  // for (var y=0; y<height; y+=stepSize) {
  //   for (var x=0; x<width; x+=stepSize) {
  //     var i = y * width + x;
  //     var darkness = (255 - vid1.pixels[i*4]) / 255;
  //     var radius = stepSize * darkness;
  //     ellipse(x, y, radius, radius);
  //   }
  // }
}


// var capture;

// function setup() {
//   createCanvas(390, 240);
//   vid1 = createCapture(VIDEO);
//   vid1.size(320, 240);
//   //capture.hide();
// }

// function draw() {
//   background(255);
//   image(vid1, 0, 0, 320, 240);
//   filter('INVERT');
// }
</script>  -->
 <script>   
    var myVideo;

function setup() {
    createCanvas(640, 480);
    // specify multiple formats for different browsers
    myVideo = createCapture(VIDEO);
    // myVideo = createVideo(['assets/2015capstonefair.webm','assets/2015capstonefair.mp4']);
    // myVideo.loop();
    // myVideo.hide();
    ellipseMode(CENTER);
    noStroke();
    // $('canvas').css('transform','scale(' + window.innerWidth / 1280 + ')');
    // console.log(windowWidth / 1280 +', ' + windowHeight / 720);
}

function draw() {
    background(255);
    myVideo.loadPixels();
    var stepSize = round(map(mouseX, 0, windowWidth, 10, 80));
    // var stepSize = round(constrain(mouseX / 10, 10, 80));
    for (var y = 0; y < height; y += stepSize) {
        for (var x = 0; x < width; x += stepSize) {

            // calculate pixel position in a linear array of pixels
            var i = (y * width + x) * 4;
            // set ellipse radius based on darkness of pixel
            var darkness = (255 - myVideo.pixels[i]) / 255;
            var radius = stepSize * darkness;
            // provide RGB color
            fill(myVideo.pixels[i], myVideo.pixels[i + 1], myVideo.pixels[i + 2]);
            ellipse(x, y, radius, radius);
        }
    }
}

    </script>


</body>
</html>
